(this["webpackJsonpgallery-app"]=this["webpackJsonpgallery-app"]||[]).push([[0],{16:function(e,t,a){e.exports=a(28)},21:function(e,t,a){},22:function(e,t,a){},28:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(15),l=a.n(i),o=(a(21),a(22),a(3)),c=a.n(o),s=a(5),u=a(6),m=a(7),d=a(9),g=a(8),p=a(10),h=a(11),f=a.n(h);a(29),a(25);f.a.initializeApp({apiKey:"AIzaSyDwmHjgLUTmizkk7dUFdh-MHnx4BIh0iEo",authDomain:"galleryreact-be5e3.firebaseapp.com",databaseURL:"https://galleryreact-be5e3.firebaseio.com",projectId:"galleryreact-be5e3",storageBucket:"galleryreact-be5e3.appspot.com",messagingSenderId:"406751940283",appId:"1:406751940283:web:74ce025c53abbd05aee39e",measurementId:"G-2HFXPXJQS7"});var b=f.a.storage(),v=f.a.database(),E=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).handleFileChange=function(e){var t=e.target.files[0];if(t&&t.type.includes("image")){var n=e.target.files[0];a.setState((function(){return{image:n}}))}else alert("You can upload only images!"),e.target.value=""},a.handleNameChange=function(e){a.setState({name:e.target.value})},a.getUploadingProcent=function(e){return Math.round(e.bytesTransferred/e.totalBytes*100)},a.handleUpload=function(){var e=a.state.image;if(e&&a.state.name){var t=a.state.name;b.ref("images/".concat(e.name)).put(e).on("state_changed",(function(e){var t=a.getUploadingProcent(e);a.setState((function(){return{loadingStatus:"Uploading - ".concat(t,"%")}}))}),(function(e){console.log(e)}),Object(s.a)(c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,b.ref("images/").child(e.name).getDownloadURL();case 2:r=n.sent,v.ref("images/".concat(t)).set({name:t,url:r},(function(e){e?console.log(e):a.props.handleUpdate(!0)}));case 4:case"end":return n.stop()}}),n)})))),a.setState((function(){return{image:null,name:""}}))}else alert("Please, enter name or upload correct image")},a.state={image:null,name:"",loadingStatus:""},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:y},r.a.createElement("span",null,this.state.loadingStatus),r.a.createElement("br",null),r.a.createElement("input",{style:U,type:"file",onChange:this.handleFileChange}),r.a.createElement("br",null),r.a.createElement("label",null,"Image Title:",r.a.createElement("input",{type:"text",value:this.state.name,onChange:this.handleNameChange})),r.a.createElement("br",null),r.a.createElement("button",{style:x,onClick:this.handleUpload},"Upload"))}}]),t}(n.Component),y={backgroundColor:"#7BC8A1"},x={fontWeight:"700",color:"white",padding:"10px",textDecoration:"none",borderRadius:"3px",background:"#D77206",transition:"0.2s"},U={width:"100%",padding:"12px 20px",boxSizing:"border-box"},w={display:"inline-block",width:"350px",height:"400px",margin:"20px 25px",textAlign:"center",borderColor:"#008a77",borderStyle:"solid",padding:"5px"},k={textAlign:"center",color:"orange",fontSize:"15px"};var I=function(e){return r.a.createElement("div",{style:w},r.a.createElement("h1",{style:k},e.image.name),r.a.createElement("img",{width:"330px",height:"330px",src:e.image.url,alt:e.image.name}),r.a.createElement("button",{onClick:function(){return e.deleteImage(e.image.name)}},"Delete this image"))},S=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(g.a)(t).call(this,e))).handleUpdate=function(e){e&&a.setState((function(){return{needUpdate:!0}}))},a.componentDidMount=function(){a.getImagesFromDatabase()},a.componentDidUpdate=function(){a.state.needUpdate&&a.getImagesFromDatabase()},a.getImagesFromDatabase=function(){v.ref("images/").on("value",(function(e){var t=[];e.forEach((function(e){t.push(e.val())})),a.setState({images:[].concat(t),loading:!1,needUpdate:!1})}))},a.deleteImage=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.images.find((function(e){return e.name===t})),r=n.url,e.next=3,b.refFromURL(r).delete();case 3:v.ref("images/".concat(t)).remove();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={images:[],needUpdate:!0},a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state.images.map((function(t,a){return r.a.createElement(I,{key:a,image:t,deleteImage:e.deleteImage})}));return this.state.loading?r.a.createElement("main",null,r.a.createElement(E,{handleUpdate:this.handleUpdate}),r.a.createElement("div",null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435...")):!this.state.loading&&t.length?r.a.createElement("main",null,r.a.createElement(E,{handleUpdate:this.handleUpdate}),r.a.createElement("div",null,t),";"):r.a.createElement("main",null,r.a.createElement(E,{handleUpdate:this.handleUpdate}),r.a.createElement("div",null,"Nothing..."))}}]),t}(n.Component);var j=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(S,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[16,1,2]]]);
//# sourceMappingURL=main.be861fb9.chunk.js.map